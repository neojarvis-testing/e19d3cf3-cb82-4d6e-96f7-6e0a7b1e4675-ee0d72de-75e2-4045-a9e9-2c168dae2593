<div *ngIf="isLoggedIn()">
  <app-usernav></app-usernav>
  
  <div class="dashboard-container">
      <div class="dashboard-header">
          <h1>Available Savings Plans</h1>
          <div class="search-filter">
              <div class="search-box">
                  <input type="text" [(ngModel)]="name" placeholder="Search plans..." (input)="filterByName(name)">
                  <i class="fas fa-search search-icon"></i>
              </div>
              <div class="filter-box">
                  <select [(ngModel)]="riskLevel" (change)="filterByRiskLevel()">
                      <option value="All">All Risk Levels</option>
                      <option value="Low">Low Risk</option>
                      <option value="Medium">Medium Risk</option>
                      <option value="High">High Risk</option>
                  </select>
              </div>
          </div>
      </div>

      <div class="plans-grid">
          <div class="plan-card" *ngFor="let savingsPlan of savingsPlans; let i = index">
              <div class="plan-header" [ngClass]="{'low-risk': savingsPlan.RiskLevel === 'Low', 'medium-risk': savingsPlan.RiskLevel === 'Medium', 'high-risk': savingsPlan.RiskLevel === 'High'}">
                  <h3>{{savingsPlan.Name}}</h3>
                  <span class="risk-badge">{{savingsPlan.RiskLevel}} Risk</span>
              </div>
              <div class="plan-body">
                  <div class="plan-info">
                      <div class="info-item">
                          <span class="label">Goal Amount:</span>
                          <span class="value">{{savingsPlan.GoalAmount | currency:'INR':'symbol':'1.0-0'}}</span>
                      </div>
                      <div class="info-item">
                          <span class="label">Time Frame:</span>
                          <span class="value">{{savingsPlan.TimeFrame}} years</span>
                      </div>
                      <div class="info-item">
                          <span class="label">Status:</span>
                          <span class="value status" [ngClass]="{'active': savingsPlan.Status === 'Active', 'inactive': savingsPlan.Status === 'Inactive'}">
                              {{savingsPlan.Status}}
                          </span>
                      </div>
                  </div>
                  <p class="plan-description">{{savingsPlan.Description}}</p>
              </div>
              <div class="plan-footer">
                  <button class="apply-btn" [disabled]="isApplied[i] || savingsPlan.Status === 'Inactive'" 
                          [routerLink]="['/userplanapplication', savingsPlan.SavingsPlanId]">
                      <span *ngIf="!isApplied[i] && savingsPlan.Status === 'Active'">Apply Now</span>
                      <span *ngIf="isApplied[i]">Already Applied</span>
                      <span *ngIf="savingsPlan.Status === 'Inactive'">Currently Unavailable</span>
                  </button>
              </div>
          </div>
      </div>
  </div>
</div>
<div *ngIf="!isLoggedIn()">
  <app-error></app-error>
</div>